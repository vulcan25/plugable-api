Based on: [https://gist.github.com/theorm/5440144]
